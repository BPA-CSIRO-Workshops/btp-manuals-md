
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="This contains all material for Markdown version of BTP workshops.">
      
      
        <meta name="author" content="Authors">
      
      
      
        <link rel="prev" href="../../btp-module-ngs-bio/biol/">
      
      
        <link rel="next" href="../../btp-module-denovo-canu/denovo_canu/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.2">
    
    
      
        <title>de novo Genome Assembly - Markdown Manuals for Bioinformatics Training Platform (BTP)</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.f56500e0.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.2505c338.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/details.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#key-learning-outcomes" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Markdown Manuals for Bioinformatics Training Platform (BTP)" class="md-header__button md-logo" aria-label="Markdown Manuals for Bioinformatics Training Platform (BTP)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Markdown Manuals for Bioinformatics Training Platform (BTP)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              de novo Genome Assembly
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Markdown Manuals for Bioinformatics Training Platform (BTP)" class="md-nav__button md-logo" aria-label="Markdown Manuals for Bioinformatics Training Platform (BTP)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Markdown Manuals for Bioinformatics Training Platform (BTP)
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../trainers/trainers/" class="md-nav__link">
        The Trainers
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Timetable
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Timetable" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Timetable
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../timetables/timetable_introNGS/" class="md-nav__link">
        Intro to NGS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../timetables/timetable_cancer/" class="md-nav__link">
        Cancer Genomics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../timetables/timetable_longRead/" class="md-nav__link">
        Long Read
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../preamble/" class="md-nav__link">
        Workshop Information
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Introduction to NGS Modules
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Introduction to NGS Modules" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Introduction to NGS Modules
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../btp-module-ngs-cli/commandline/" class="md-nav__link">
        Introduction to Command Line
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../btp-module-ngs-qc/ngs-qc/" class="md-nav__link">
        Data Quality
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../btp-module-ngs-mapping/alignment/" class="md-nav__link">
        Read Alignment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../btp-module-chip-seq/chip-seq/" class="md-nav__link">
        ChIP-seq
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../btp-module-rna-seq/rna-seq/" class="md-nav__link">
        RNA-Seq
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../btp-module-ngs-bio/biol/" class="md-nav__link">
        NGS Biological Insight
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          de novo Genome Assembly
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        de novo Genome Assembly
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#key-learning-outcomes" class="md-nav__link">
    Key Learning Outcomes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources-youll-be-using" class="md-nav__link">
    Resources You’ll be Using
  </a>
  
    <nav class="md-nav" aria-label="Resources You’ll be Using">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tools-used" class="md-nav__link">
    Tools Used
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sources-of-data" class="md-nav__link">
    Sources of Data
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepare-the-environment" class="md-nav__link">
    Prepare the Environment
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#downloading-and-compiling-velvet" class="md-nav__link">
    Downloading and Compiling Velvet
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#assembling-paired-end-reads-using-velvet" class="md-nav__link">
    Assembling Paired-end Reads using Velvet
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#amos-hawkeye" class="md-nav__link">
    AMOS Hawkeye
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#velvet-and-data-quality" class="md-nav__link">
    Velvet and Data Quality
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../btp-module-denovo-canu/denovo_canu/" class="md-nav__link">
        DeNovo Canu
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Cancer Genomics Modules
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Cancer Genomics Modules" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Cancer Genomics Modules
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cancer-module-alignment/alignment/" class="md-nav__link">
        Read Alignment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cancer-module-snv/snv/" class="md-nav__link">
        Single Nucleotide Variant Calling and Annotation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cancer-module-cnv/cnv-tut/" class="md-nav__link">
        Copy Number Variation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cancer-module-sv/sv_tut/" class="md-nav__link">
        Structural Variant Analysis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cancer-module-viz/visu/" class="md-nav__link">
        Variant Visualisation
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_6" type="checkbox" id="__nav_6_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6_6">
          Somatic Mutations
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Somatic Mutations" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_6">
          <span class="md-nav__icon md-icon"></span>
          Somatic Mutations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cancer-module-somatic/01_signatures/" class="md-nav__link">
        Assessing somatic mutational signatures
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cancer-module-somatic/02_intogen/" class="md-nav__link">
        Cohort analysis for the identification of driver genes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          DeNovo Modules
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="DeNovo Modules" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          DeNovo Modules
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../denovo-module-bac/bac_asm/" class="md-nav__link">
        Bacterial Assembly
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../denovo-module-euk/eukaryotic_assem/" class="md-nav__link">
        Eukaryote Assembly
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../denovo-module-scaffolding/scaffold/" class="md-nav__link">
        Scaffolding
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Metagenomics Modules
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Metagenomics Modules" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Metagenomics Modules
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../metagenomics-module-qc/ngs-qc/" class="md-nav__link">
        Metagenomics QC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../metagenomics-module-tax/tax/" class="md-nav__link">
        Metagenomics Taxonomic
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../metagenomics-module-vis/vis/" class="md-nav__link">
        Metagenomics Visualisation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../metagenomics-module-wga/wga/" class="md-nav__link">
        Metagenomics WGA
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../metagenomics-module-fda/fda/" class="md-nav__link">
        Metagenomics Functional Analysis
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#key-learning-outcomes" class="md-nav__link">
    Key Learning Outcomes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources-youll-be-using" class="md-nav__link">
    Resources You’ll be Using
  </a>
  
    <nav class="md-nav" aria-label="Resources You’ll be Using">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tools-used" class="md-nav__link">
    Tools Used
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sources-of-data" class="md-nav__link">
    Sources of Data
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepare-the-environment" class="md-nav__link">
    Prepare the Environment
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#downloading-and-compiling-velvet" class="md-nav__link">
    Downloading and Compiling Velvet
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#assembling-paired-end-reads-using-velvet" class="md-nav__link">
    Assembling Paired-end Reads using Velvet
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#amos-hawkeye" class="md-nav__link">
    AMOS Hawkeye
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#velvet-and-data-quality" class="md-nav__link">
    Velvet and Data Quality
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>de novo Genome Assembly</h1>

<h2 id="key-learning-outcomes">Key Learning Outcomes<a class="headerlink" href="#key-learning-outcomes" title="Permanent link">&para;</a></h2>
<p>After completing this practical the trainee should be able to:</p>
<ul>
<li>
<p>Compile velvet with appropriate compile-time parameters set for a
    specific analysis</p>
</li>
<li>
<p>Be able to choose appropriate assembly parameters</p>
</li>
<li>
<p>Assemble a set of paired-end reads from a single insert-size library</p>
</li>
<li>
<p>Be able to visualise an assembly in AMOS Hawkeye</p>
</li>
</ul>
<h2 id="resources-youll-be-using">Resources You’ll be Using<a class="headerlink" href="#resources-youll-be-using" title="Permanent link">&para;</a></h2>
<p>Although we have provided you with an environment which contains all the
tools and data you will be using in this module, you may like to know
where we have sourced those tools and data from.</p>
<h3 id="tools-used">Tools Used<a class="headerlink" href="#tools-used" title="Permanent link">&para;</a></h3>
<p>Velvet:<br />
<a href="http://www.ebi.ac.uk/~zerbino/velvet/">http://www.ebi.ac.uk/~zerbino/velvet/</a></p>
<p>AMOS Hawkeye:<br />
<a href="http://apps.sourceforge.net/mediawiki/amos/index.php?title=Hawkeye">http://apps.sourceforge.net/mediawiki/amos/index.php?title=Hawkeye</a></p>
<p>gnx-tools:<br />
<a href="https://github.com/mh11/gnx-tools">https://github.com/mh11/gnx-tools</a></p>
<p>FastQC:<br />
<a href="http://www.bioinformatics.bbsrc.ac.uk/projects/fastqc/">http://www.bioinformatics.bbsrc.ac.uk/projects/fastqc/</a></p>
<p>R:<br />
<a href="http://www.r-project.org/">http://www.r-project.org/</a></p>
<h3 id="sources-of-data">Sources of Data<a class="headerlink" href="#sources-of-data" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><a href="ftp://ftp.ensemblgenomes.org/pub/release-8/bacteria/fasta/Staphylococcus/s_aureus_mrsa252/dna/s_aureus_mrsa252.EB1_s_aureus_mrsa252.dna.chromosome.Chromosome.fa.gz">ftp://ftp.ensemblgenomes.org/pub/release-8/bacteria/fasta/Staphylococcus/s_aureus_mrsa252/dna/s_aureus_mrsa252.EB1_s_aureus_mrsa252.dna.chromosome.Chromosome.fa.gz</a></p>
</li>
<li>
<p><a href="http://www.ebi.ac.uk/ena/data/view/SRX008042">http://www.ebi.ac.uk/ena/data/view/SRX008042</a></p>
</li>
<li>
<p><a href="ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR022/SRR022852/SRR022852_1.fastq.gz">ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR022/SRR022852/SRR022852_1.fastq.gz</a></p>
</li>
<li>
<p><a href="ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR022/SRR022852/SRR022852_2.fastq.gz">ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR022/SRR022852/SRR022852_2.fastq.gz</a></p>
</li>
<li>
<p><a href="ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR023/SRR023408/SRR023408_1.fastq.gz">ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR023/SRR023408/SRR023408_1.fastq.gz</a></p>
</li>
<li>
<p><a href="ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR023/SRR023408/SRR023408_2.fastq.gz">ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR023/SRR023408/SRR023408_2.fastq.gz</a></p>
</li>
</ul>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>The aim of this module is to become familiar with performing <em>de novo</em>
genome assembly using Velvet, a de Bruijn graph based assembler, on a
variety of sequence data.</p>
<h2 id="prepare-the-environment">Prepare the Environment<a class="headerlink" href="#prepare-the-environment" title="Permanent link">&para;</a></h2>
<p>The first exercise should get you a little more comfortable with the
computer environment and the command line.</p>
<p>First make sure that you are in the denovo working directory by typing:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>cd /home/trainee/denovo
</code></pre></div></td></tr></table></div>

<p>and making absolutely sure you’re there by typing:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>pwd
</code></pre></div></td></tr></table></div>

<p>Now create sub-directories for this and the two other velvet practicals.
All these directories will be made as sub-directories of a directory for
the whole course called NGS. For this you can use the following
commands:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>mkdir -p NGS/velvet/{part1,part2}
</code></pre></div></td></tr></table></div>

<p>The <code>-p</code> tells <code>mkdir</code> (make directory) to make any parent directories
if they don’t already exist. You could have created the above
directories one-at-a-time by doing this instead:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code>mkdir NGS
mkdir NGS/velvet
mkdir NGS/velvet/part1
mkdir NGS/velvet/part2
</code></pre></div></td></tr></table></div>

<p>After creating the directories, examine the structure and move into the
directory ready for the first velvet exercise by typing:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code>ls -R NGS
cd NGS/velvet/part1
pwd
</code></pre></div></td></tr></table></div>

<h2 id="downloading-and-compiling-velvet">Downloading and Compiling Velvet<a class="headerlink" href="#downloading-and-compiling-velvet" title="Permanent link">&para;</a></h2>
<p>For the duration of this workshop, all the software you require has been
set up for you already. This might not be the case when you return to
“real life”. Many of the programs you will need, including velvet, are
quite easy to set up, it might be instructive to try a couple.</p>
<p>Although you will be using the preinstalled version of velvet, it is
useful to know how to compile velvet as some of the parameters you might
like to control can only be set at compile time. You can find the latest
version of velvet at:</p>
<p><a href="http://www.ebi.ac.uk/~zerbino/velvet/">http://www.ebi.ac.uk/~zerbino/velvet/</a></p>
<p>You could go to this URL and download the latest velvet version, or
equivalently, you could type the following, which will download, unpack,
inspect, compile and execute your locally compiled version of velvet:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code>cd /home/trainee/denovo/NGS/velvet/part1
pwd
tar xzf /home/trainee/denovo/data/velvet_1.2.10.tgz
ls -R
cd velvet_1.2.10
make
./velveth
</code></pre></div></td></tr></table></div>

<p>The standout displayed to screen when ’make’ runs may contain an error
message but it is ignored</p>
<p>Take a look at the executables you have created. They will be displayed
as green by the command:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>ls --color=always
</code></pre></div></td></tr></table></div>

<p>The switch <code>–color</code>, instructs that files be coloured according to their
type. This is often the default but we are just being explicit. By
specifying the value <code>always</code>, we ensure that colouring is always
applied, even from a script.</p>
<p>Have a look of the output the command produces and you will see that
<code>MAXKMERLENGTH=31</code> and <code>CATEGORIES=2</code> parameters were passed into the
compiler.</p>
<p>This indicates that the default compilation was set for de Bruijn graph
k-mers of maximum size 31 and to allow a maximum of just 2 read
categories. You can override these, and other, default configuration
choices using command line parameters. Assume, you want to run velvet
with a k-mer length of 41 using 3 categories, velvet needs to be
recompiled to enable this functionality by typing:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code>make clean
make MAXKMERLENGTH=41 CATEGORIES=3
./velveth
</code></pre></div></td></tr></table></div>

<p>Discuss with the persons next to you the following questions:</p>
<div class="admonition note">
<p class="admonition-title">Question</p>
<p>What are the consequences of the parameters you have given make for velvet?</p>
</div>
<div class="admonition success">
<details>
<summary><strong>Answer</strong></summary>
<p>MAXKMERLENGTH: increase the max k-mer length from 31 to 41   <br />
CATEGORIES: paired-end data require to be put into separate categories. By increasing this parameter from 2 to 3 allows you to process 3 paired / mate-pair libraries and unpaired data.</p>
</details>
</div>
<div class="admonition note">
<p class="admonition-title">Question</p>
<p>Why does Velvet use k-mer 31 and 2 categories as default?</p>
</div>
<div class="admonition success">
<details>
<summary><strong>Answer</strong></summary>
<p>Possibly a number of reason:    <br />
1) odd number to avoid palindromes      <br />
2) The first reads were very short (20-40 bp) and there were hardly any paired-end data around so there was no need to allow for longer k-mer lengths / more categories.      <br />
3) For programmers: 31 bp get stored in 64 bits (using 2bit encoding)</p>
</details>
</div>
<div class="admonition note">
<p class="admonition-title">Question</p>
<p>Should you get better results by using a longer k-mer length?</p>
</div>
<div class="admonition success">
<details>
<summary><strong>Answer</strong></summary>
<p>If you can achieve a good k-mer coverage - yes.</p>
</details>
</div>
<p>What effect would the following compile-time parameters have on velvet:</p>
<div class="admonition note">
<p class="admonition-title">Question</p>
</div>
<p>OPENMP=Y</p>
<div class="admonition success">
<details>
<summary><strong>Answer</strong></summary>
<p>Turn on multithreading</p>
</details>
</div>
<div class="admonition note">
<p class="admonition-title">Question</p>
<p>LONGSEQUENCES=Y</p>
</div>
<div class="admonition success">
<details>
<summary><strong>Answer</strong></summary>
<p>Assembling reads / contigs longer than 32kb long</p>
</details>
</div>
<div class="admonition note">
<p class="admonition-title">Question</p>
<p>BIGASSEMBLY=Y</p>
</div>
<div class="admonition success">
<details>
<summary><strong>Answer</strong></summary>
<p>Using more than 2.2 billion reads</p>
</details>
</div>
<div class="admonition note">
<p class="admonition-title">Question</p>
<p>SINGLE_COV_CAT=Y</p>
</div>
<div class="admonition success">
<details>
<summary><strong>Answer</strong></summary>
<p>Merge all coverage statistics into a single variable - save memory</p>
</details>
</div>
<p>For a further description of velvet compile and runtime parameters
please see the velvet Manual:
<a href="https://github.com/dzerbino/velvet/wiki/Manual">https://github.com/dzerbino/velvet/wiki/Manual</a></p>
<h2 id="assembling-paired-end-reads-using-velvet">Assembling Paired-end Reads using Velvet<a class="headerlink" href="#assembling-paired-end-reads-using-velvet" title="Permanent link">&para;</a></h2>
<p>The use of paired-end data in <em>de novo</em> genome assembly results in
better quality assemblies, particularly for larger, more complex
genomes. In addition, paired-end constraint violation (expected distance
and orientation of paired reads) can be used to identify misassemblies.</p>
<p>If you are doing <em>de novo</em> assembly, pay the extra and get paired-ends:
they’re worth it!</p>
<p>The data you will examine in this exercise is again from Staphylococcus
aureus which has a genome of around 3MBases. The reads are Illumina
paired end with an insert size of ~350 bp.</p>
<p>The required data can be downloaded from the SRA. Specifically, the run
data (SRR022852) from the SRA Sample SRS004748.</p>
<p>The following exercise focuses on preparing the paired-end FASTQ files
ready for Velvet, using Velvet in paired-end mode and comparing results
with Velvet’s ’auto’ option.</p>
<p>First move to the directory you made for this exercise and make a
suitable named directory for the exercise:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code>cd /home/trainee/denovo/NGS/velvet/part2 
mkdir SRS004748 
cd SRS004748
</code></pre></div></td></tr></table></div>

<p>There is no need to download the read files, as they are already stored
locally. You will simply create a symlink to this pre-downloaded data
using the following commands:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>ln -s /home/trainee/denovo/data/SRR022852_?.fastq.gz ./
</code></pre></div></td></tr></table></div>

<p>It is interesting to monitor the computer’s resource utilisation,
particularly memory. A simple way to do this is to open a second
terminal and in it type:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>top
</code></pre></div></td></tr></table></div>

<p><code>top</code> is a program that continually monitors all the processes running
on your computer, showing the resources used by each. Leave this running
and refer to it periodically throughout your Velvet analyses.
Particularly if they are taking a long time or whenever your curiosity
gets the better of you. You should find that as this practical
progresses, memory usage will increase significantly.</p>
<p>Now, back to the first terminal, you are ready to run <code>velveth</code> and
<code>velvetg</code>. The reads are <code>-shortPaired</code> and for the first run you should
not use any parameters for <code>velvetg</code>.</p>
<p>From this point on, where it will be informative to time your runs. This
is very easy to do, just prefix the command to run the program with the
command <code>time</code>. This will cause UNIX to report how long the program took
to complete its task.</p>
<p>Set the two stages of velvet running, whilst you watch the memory usage
as reported by <code>top</code>. Time the <code>velvetg</code> stage:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code>velveth run_25 25 -fmtAuto -create_binary -shortPaired -separate SRR022852_1.fastq.gz SRR022852_2.fastq.gz
time velvetg run_25
</code></pre></div></td></tr></table></div>

<div class="admonition note">
<p class="admonition-title">Question</p>
<p>What does <code>-fmtAuto</code> and <code>-create_binary</code> do? (see help menu)</p>
</div>
<div class="admonition success">
<details>
<summary>Answer</summary>
<p><code>-fmtAuto</code> tries to detect the correct format of the input files e.g. FASTA, FASTQ and whether they are compressed or not.   <br />
<code>-create_binary</code> outputs sequences as a binary file. That means that <code>velvetg</code> can read the sequences from the binary file more quickly that from the original sequence files.</p>
</details>
</div>
<div class="admonition note">
<p class="admonition-title">Question</p>
<p>Comment on the use of memory and CPU for <code>velveth</code> and <code>velvetg</code>?</p>
</div>
<div class="admonition success">
<details>
<summary>Answer</summary>
<p><code>velveth</code> uses only one CPU while <code>velvetg</code> uses all possible CPUs for some parts of the calculation.</p>
</details>
</div>
<div class="admonition note">
<p class="admonition-title">Question</p>
<p>How long did <code>velvetg</code> take?</p>
</div>
<div class="admonition success">
<details>
<summary>Answer</summary>
<p>My own measurements are:   <br />
<code>real 1m8.877s; user 4m15.324s; sys 0m4.716s</code></p>
</details>
</div>
<p>Next, after saving your <code>contigs.fa</code> file from being overwritten, set
the cut-off parameters that you investigated in the previous exercise
and rerun <code>velvetg</code>. time and monitor the use of resources as
previously. Start with <code>-cov_cutoff 16</code> thus:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code>mv run_25/contigs.fa run_25/contigs.fa.0
time velvetg run_25 -cov_cutoff 16
</code></pre></div></td></tr></table></div>

<p>Up until now, <code>velvetg</code> has ignored the paired-end information. Now try
running <code>velvetg</code> with both <code>-cov_cutoff 16</code> and <code>-exp_cov 26</code>, but
first save your <code>contigs.fa</code> file. By using <code>-cov_cutoff</code> and
<code>-exp_cov</code>, <code>velvetg</code> tries to estimate the insert length, which you
will see in the <code>velvetg</code> output. The command is, of course:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code>mv run_25/contigs.fa run_25/contigs.fa.1
time velvetg run_25 -cov_cutoff 16 -exp_cov 26
</code></pre></div></td></tr></table></div>

<div class="admonition note">
<p class="admonition-title">Question</p>
<p>Comment on the time required, use of memory and CPU for <code>velvetg</code>?</p>
</div>
<div class="admonition success">
<details>
<summary>Answer</summary>
<p>Runtime is lower when velvet can reuse previously calculated data. By using <code>-exp_cov</code>, the memory usage increases.</p>
</details>
</div>
<div class="admonition note">
<p class="admonition-title">Question</p>
<p>Which insert length does Velvet estimate?</p>
</div>
<div class="admonition success">
<details>
<summary>Answer</summary>
<p>Paired-end library 1 has length: 228, sample standard deviation: 26</p>
</details>
</div>
<p>Next try running <code>velvetg</code> in ‘paired-end mode‘. This entails running
<code>velvetg</code> specifying the insert length with the parameter <code>-ins_length</code>
set to 350. Even though velvet estimates the insert length it is always
advisable to check / provide the insert length manually as velvet can
get the statistics wrong due to noise. Just in case, save your last
version of <code>contigs.fa</code>. The commands are:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code>mv run_25/contigs.fa run_25/contigs.fa.2
time velvetg run_25 -cov_cutoff 16 -exp_cov 26 -ins_length 350
mv run_25/contigs.fa run_25/contigs.fa.3
</code></pre></div></td></tr></table></div>

<div class="admonition note">
<p class="admonition-title">Question</p>
<p>How fast was this run?</p>
</div>
<div class="admonition success">
<details>
<summary>Answer</summary>
<p>My own measurements are:   <br />
<code>real 0m29.792s; user 1m4.372s; sys 0m3.880s</code></p>
</details>
</div>
<p>Take a look into the Log file.</p>
<div class="admonition note">
<p class="admonition-title">Question</p>
<p>What is the N50 value for the <code>velvetg</code> runs using the switches</p>
</div>
<div class="admonition success">
<details>
<summary>Answer</summary>
<p>Base run: 19,510 bp  <br />
<code>-cov_cutoff 16</code>: 24,739 bp   <br />
<code>-cov_cutoff 16 -exp_cov 26</code>: 61,793 bp   <br />
<code>-cov_cutoff 16 -exp_cov 26 -ins_length 350</code>: n50 of 62,740 bp; max 194,649 bp; total 2,871,093 bp     </p>
</details>
</div>
<p>Try giving the <code>-cov_cutoff</code> and/or <code>-exp_cov</code> parameters the value
<code>auto</code>. See the <code>velvetg</code> help to show you how. The information Velvet
prints during running includes information about the values used
(coverage cut-off or insert length) when using the <code>auto</code> option.</p>
<div class="admonition note">
<p class="admonition-title">Question</p>
<p>What coverage values does Velvet choose (hint: look at the output that Velvet produces while running)?</p>
</div>
<div class="admonition success">
<details>
<summary>Answer</summary>
<p>Median coverage depth = 26.021837  <br />
Removing contigs with coverage &lt; 13.010918 …</p>
</details>
</div>
<div class="admonition note">
<p class="admonition-title">Question</p>
<p>How does the N50 value change?</p>
</div>
<div class="admonition success">
<details>
<summary>Answer</summary>
<p>n50 of 68,843 bp; max 194,645 bp; total 2,872,678 bp</p>
</details>
</div>
<p>Run <code>gnx</code> on all the <code>contig.fa</code> files you have generated in the course
of this exercise. The command will be:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>gnx -min 100 -nx 25,50,75 run_25/contigs.fa*
</code></pre></div></td></tr></table></div>

<div class="admonition note">
<p class="admonition-title">Question</p>
<p>For which runs are there Ns in the <code>contigs.fa</code> file and why?</p>
</div>
<div class="admonition success">
<details>
<summary>Answer</summary>
<p>contigs.fa.2, contigs.fa.3, contigs.fa</p>
</details>
</div>
<p>Velvet tries to use the provided (or infers) the insert length and fills
ambiguous regions with Ns.</p>
<p>Comment on the number of contigs and total length generated for each
run.</p>
<table>
<thead>
<tr>
<th>Filename</th>
<th>No. contigs</th>
<th style="text-align: right;">Total length</th>
<th style="text-align: center;">No. Ns</th>
</tr>
</thead>
<tbody>
<tr>
<td>Contigs.fa.0</td>
<td>631</td>
<td style="text-align: right;">2,830,659</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td>Contigs.fa.1</td>
<td>580</td>
<td style="text-align: right;">2,832,670</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td>Contigs.fa.2</td>
<td>166</td>
<td style="text-align: right;">2,849,919</td>
<td style="text-align: center;">4,847</td>
</tr>
<tr>
<td>Contigs.fa.3</td>
<td>166</td>
<td style="text-align: right;">2,856,795</td>
<td style="text-align: center;">11,713</td>
</tr>
<tr>
<td>Contigs.fa</td>
<td>163</td>
<td style="text-align: right;">2,857,439</td>
<td style="text-align: center;">11,526</td>
</tr>
</tbody>
</table>
<h2 id="amos-hawkeye">AMOS Hawkeye<a class="headerlink" href="#amos-hawkeye" title="Permanent link">&para;</a></h2>
<p>We will now output the assembly in the AMOS massage format and visualise
the assembly using AMOS Hawkeye.</p>
<p>Run <code>velvetg</code> with appropriate arguments and output the AMOS message
file, then convert it to an AMOS bank and open it in Hawkeye:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code>time velvetg run_25 -cov_cutoff 16 -exp_cov 26 -ins_length 350 -amos_file yes -read_trkg yes 
time bank-transact -c -b run_25/velvet_asm.bnk -m run_25/velvet_asm.afg         
hawkeye run_25/velvet_asm.bnk
</code></pre></div></td></tr></table></div>

<p>Looking at the scaffold view of a contig, comment on the proportion of
“happy mates” to “compressed mates” and “stretched mates”.</p>
<p>Nearly all mates are compressed with no stretched mates and very few
happy mates.</p>
<div class="admonition note">
<p class="admonition-title">Question</p>
<p>What is the mean and standard deviation of the insert size reported under the Libraries tab?</p>
</div>
<div class="admonition success">
<details>
<summary>Answer</summary>
<p>Mean: 350 bp SD: 35 bp</p>
</details>
</div>
<div class="admonition note">
<p class="admonition-title">Question</p>
<p>Look at the actual distribution of insert sizes for this library. Can you explain where there is a difference between the mean and SD reported in those two places?</p>
</div>
<div class="admonition success">
<details>
<summary>Answer</summary>
<p>We specified <code>-ins_length 350</code> to the <code>velvetg</code> command. Velvet uses this value, in the AMOS message file that it outputs, rather than its own estimate.</p>
</details>
</div>
<p>You can get AMOS to re-estimate the mean and SD of insert sizes using
intra-contig pairs. First, close Hawkeye and then run the following
commands before reopening the AMOS bank to see what has changed.</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code>asmQC -b run_25/velvet_asm.bnk -scaff -recompute -update -numsd 2
hawkeye run_25/velvet_asm.bnk
</code></pre></div></td></tr></table></div>

<p>Looking at the scaffold view of a contig, comment on the proportion of
“happy mates” to “compressed mates” and “stretched mates”.</p>
<p>There are only a few compressed and stretched mates compared to happy
mates. There are similar numbers of stretched and compressed mates.</p>
<div class="admonition note">
<p class="admonition-title">Question</p>
<p>What is the mean and standard deviation of the insert size reported under the Libraries tab?</p>
</div>
<div class="admonition success">
<details>
<summary>Answer</summary>
<p>Mean: 226 bp SD: 25 bp</p>
</details>
</div>
<div class="admonition note">
<p class="admonition-title">Question</p>
<p>Look at the actual distribution of insert sizes for this library. Does the mean and SD reported in both places now match?</p>
</div>
<div class="admonition success">
<details>
<summary>Answer</summary>
<p>Yes</p>
</details>
</div>
<div class="admonition note">
<p class="admonition-title">Question</p>
<p>Can you find a region with an unusually high proportion of stretched, compressed, incorrectly orientated or linking mates? What might this situation indicate?</p>
</div>
<div class="admonition success">
<details>
<summary>Answer</summary>
<p>This would indicate a possible misassembly and worthy of further investigation.   <br />
Look at the largest scaffold, there are stacks of stretched pairs which span contig boundaries. This indicates that the gap size has been underestimated during the scaffolding phase.</p>
</details>
</div>
<h2 id="velvet-and-data-quality">Velvet and Data Quality<a class="headerlink" href="#velvet-and-data-quality" title="Permanent link">&para;</a></h2>
<p>So far we have used the raw read data without performing any quality
control or read trimming prior to doing our velvet assemblies.</p>
<p>Velvet does not use quality information present in FASTQ files.</p>
<p>For this reason, it is vitally important to perform read QC and quality
trimming. In doing so, we remove errors/noise from the dataset which in
turn means velvet will run faster, will use less memory and will produce
a better assembly. Assuming we haven’t compromised too much on coverage.</p>
<p>To investigate the effect of data quality, we will use the run data
(SRR023408) from the SRA experiment SRX008042. The reads are Illumina
paired end with an insert size of 92 bp.</p>
<p>Go back to the main directory for this exercise and create and enter a
new directory dedicated to this phase of the exercise. The commands are:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code>cd /home/trainee/denovo/NGS/velvet/part2 
mkdir SRX008042 
cd SRX008042
</code></pre></div></td></tr></table></div>

<p>Create symlinks to the read data files that we downloaded for you from
the SRA:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>ln -s /home/trainee/denovo/data/SRR023408_?.fastq.gz ./
</code></pre></div></td></tr></table></div>

<p>We will use FastQC, a tool you should be familiar with, to visualise the
quality of our data. We will use FastQC in the Graphical User Interface
(GUI) mode.</p>
<p>Start FastQC and set the process running in the background, by using a
trailing <code>&amp;</code>, so we get control of our terminal back for entering more
commands:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>fastqc &amp;
</code></pre></div></td></tr></table></div>

<p>Open the two compressed FASTQ files (File -&gt; Open) by selecting them
both and clicking OK). Look at tabs for both files:</p>
<p><img alt="image" src="../images/paired_fastqc.png" /></p>
<div class="admonition note">
<p class="admonition-title">Question</p>
<p>Are the quality scores the same for both files?</p>
</div>
<div class="admonition success">
<details>
<summary>Answer</summary>
<p>Overall yes</p>
</details>
</div>
<div class="admonition note">
<p class="admonition-title">Question</p>
<p>Which value varies?</p>
</div>
<div class="admonition success">
<details>
<summary>Answer</summary>
<p>Per sequence quality scores</p>
</details>
</div>
<div class="admonition note">
<p class="admonition-title">Question</p>
<p>Take a look at the Per base sequence quality for both files. Did you note that it is not good for either file?</p>
</div>
<div class="admonition success">
<details>
<summary>Answer</summary>
<p>The quality score of both files drop very fast. Qualities of the REV strand drop faster than the FWD strand. This is because the template has been sat around while the FWD strand was sequenced.</p>
</details>
</div>
<div class="admonition note">
<p class="admonition-title">Question</p>
<p>At which positions would you cut the reads if we did “fixed length trimming”?</p>
</div>
<div class="admonition success">
<details>
<summary>Answer</summary>
<p>Looking at the “Per base quality&rdquo; and “Per base sequence content”, I would choose around 27</p>
</details>
</div>
<div class="admonition note">
<p class="admonition-title">Question</p>
<p>Why does the quality deteriorate towards the end of the read?</p>
</div>
<div class="admonition success">
<details>
<summary>Answer</summary>
<p>Errors more likely for later cycles</p>
</details>
</div>
<div class="admonition note">
<p class="admonition-title">Question</p>
<p>Does it make sense to trim the 5’ start of reads?</p>
</div>
<div class="admonition success">
<details>
<summary>Answer</summary>
<p>Looking at the “Per base sequence content&rdquo;, yes - there is a clear signal at the beginning.</p>
</details>
</div>
<p>Have a look at the other options that FastQC offers.</p>
<div class="admonition note">
<p class="admonition-title">Question</p>
<p>Which other statistics could you use to support your trimming strategy?</p>
</div>
<div class="admonition success">
<details>
<summary>Answer</summary>
<p>“Per base sequence content&rdquo;, “Per base GC content&rdquo;, “Kmer content&rdquo;, “Per base sequence quality&rdquo;</p>
</details>
</div>
<p><img alt="image" src="../images/paired_fastqc_quality_plots.png" /></p>
<p>Once you have decided what your trim points will be, close FastQC. We
will use <code>fastx_trimmer</code> from the FASTX-Toolkit to perform fixed-length
trimming. For usage information see the help:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>fastx_trimmer -h
</code></pre></div></td></tr></table></div>

<p><code>fastx_trimmer</code> is not able to read compressed FASTQ files, so we first
need to decompress the files ready for input.</p>
<p>The suggestion (hopefully not far from your own thoughts?) is that you
trim your reads as follows:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code>gunzip &lt; SRR023408_1.fastq.gz &gt; SRR023408_1.fastq
gunzip &lt; SRR023408_2.fastq.gz &gt; SRR023408_2.fastq
fastx_trimmer -Q 33 -f 1 -l 32 -i SRR023408_1.fastq -o SRR023408_trim1.fastq 
fastx_trimmer -Q 33 -f 1 -l 27 -i SRR023408_2.fastq -o SRR023408_trim2.fastq
</code></pre></div></td></tr></table></div>

<p>Many NGS read files are large. This means that simply reading and
writing files can become the bottleneck, also known as I/O bound.
Therefore, it is often good practice to avoid unnecessary disk
read/write.</p>
<div class="admonition hint">
<p class="admonition-title">Tips</p>
<p>We could do what is called pipelining to send a stream of data from one command to another, using the pipe (<code>|</code>) character, without the need for intermediary files. The following command would achieve this:       </p>
<p>gunzip &ndash;to-stdout &lt; SRR023408_1.fastq.gz | fastx_trimmer -Q 33 -f 4 -l 32 -o SRR023408_trim1.fastq   <br />
gunzip &ndash;to-stdout &lt; SRR023408_2.fastq.gz | fastx_trimmer -Q 33 -f 3 -l 29 -o SRR023408_trim2.fastq    </p>
</div>
<p>Now run <code>velveth</code> with a k-mer value of 21 for both the untrimmed and
trimmed read files in <code>-shortPaired</code> mode. Separate the output of the
two executions of <code>velveth</code> into suitably named directories, followed by
<code>velvetg</code>:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code># untrimmed reads
velveth run_21 21 -fmtAuto -create_binary -shortPaired -separate SRR023408_1.fastq SRR023408_2.fastq
time velvetg run_21

# trimmed reads
velveth run_21trim 21 -fmtAuto -create_binary -shortPaired -separate SRR023408_trim1.fastq SRR023408_trim2.fastq
time velvetg run_21trim
</code></pre></div></td></tr></table></div>

<div class="admonition note">
<p class="admonition-title">Question</p>
<p>How long did the two <code>velvetg</code> runs take?</p>
</div>
<div class="admonition success">
<details>
<summary>Answer</summary>
<p>run_25: <code>real 3m16.132s; user 8m18.261s; sys 0m7.317s</code>   <br />
run_25trim: <code>real 1m18.611s; user 3m53.140s; sys 0m4.962s</code></p>
</details>
</div>
<div class="admonition note">
<p class="admonition-title">Question</p>
<p>What N50 scores did you achieve?</p>
</div>
<div class="admonition success">
<details>
<summary>Answer</summary>
<p>Untrimmed: 11   <br />
Trimmed: 15</p>
</details>
</div>
<div class="admonition note">
<p class="admonition-title">Question</p>
<p>What were the overall effects of trimming?</p>
</div>
<div class="admonition success">
<details>
<summary>Answer</summary>
<p>Time saving, increased N50, reduced coverage</p>
</details>
</div>
<p>The evidence is that trimming improved the assembly. The thing to do
surely, is to run <code>velvetg</code> with the <code>-cov_cutoff</code> and <code>-exp_cov</code>. In
order to use <code>-cov_cutoff</code> and <code>-exp_cov</code> sensibly, you need to
investigate with R, as you did in the previous exercise, what parameter
values to use. Start up R and produce the weighted histograms:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">R</span><span class="w"> </span><span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">save</span>
<span class="nf">library</span><span class="p">(</span><span class="n">plotrix</span><span class="p">)</span><span class="w"> </span>
<span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read.table</span><span class="p">(</span><span class="s">&quot;run_21/stats.txt&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">header</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> </span>
<span class="n">data2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read.table</span><span class="p">(</span><span class="s">&quot;run_21trim/stats.txt&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">header</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> </span>
<span class="nf">par</span><span class="p">(</span><span class="n">mfrow</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
<span class="nf">weighted.hist</span><span class="p">(</span><span class="n">data</span><span class="o">$</span><span class="n">short1_cov</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">$</span><span class="n">lgth</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="o">=</span><span class="m">0</span><span class="o">:</span><span class="m">50</span><span class="p">)</span>
<span class="nf">weighted.hist</span><span class="p">(</span><span class="n">data2</span><span class="o">$</span><span class="n">short1_cov</span><span class="p">,</span><span class="w"> </span><span class="n">data2</span><span class="o">$</span><span class="n">lgth</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="o">=</span><span class="m">0</span><span class="o">:</span><span class="m">50</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

<p>Weighted k-mer coverage histograms of the paired-end reads pre-trimmed (left) and post-trimmed
(right).</p>
<p><img alt="image" src="../images/velvet_Rplot002.png" /></p>
<p>For the untrimmed read histogram (left) there is an expected coverage of
around 13 with a coverage cut-off of around 7. For the trimmed read
histogram (right) there is an expected coverage of around 9 with a
coverage cut-off of around 5.</p>
<p>If you disagree, feel free to try different settings, but first quit R
before running <code>velvetg</code>:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code>q()

time velvetg run_21 -cov_cutoff 7 -exp_cov 13 -ins_length 92
time velvetg run_21trim -cov_cutoff 5 -exp_cov 9 -ins_length 92
</code></pre></div></td></tr></table></div>

<div class="admonition note">
<p class="admonition-title">Question</p>
<p>How good does it look now?</p>
</div>
<div class="admonition success">
<details>
<summary>Answer</summary>
<p>Still not great   <br />
Runtime: Reduced runtime   <br />
Memory: Lower memory usage</p>
</details>
</div>
<div class="admonition note">
<p class="admonition-title">Question</p>
<p>K-mer choice (Can you use k-mer 31 for a read of length 30 bp?)</p>
</div>
<div class="admonition success">
<details>
<summary>Answer</summary>
<p>K-mer has to be lower than the read length and the K-mer coverage should be sufficient to produce results.</p>
</details>
</div>
<div class="admonition note">
<p class="admonition-title">Question</p>
<p>Does less data mean “worse&rdquo; results?</p>
</div>
<div class="admonition success">
<details>
<summary>Answer</summary>
<p>Not necessarily. If you have lots of data you can safely remove poor data without too much impact on overall coverage.</p>
</details>
</div>
<p>Compare the results, produced during the last exercises, with each other, </p>
<table>
<thead>
<tr>
<th style="text-align: left;">Metric</th>
<th style="text-align: right;">SRR023408</th>
<th style="text-align: right;">SRR023408.trimmed</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Overall Quality (1-5)</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">4</td>
</tr>
<tr>
<td style="text-align: left;">bp Coverage</td>
<td style="text-align: right;">95x (37bp; 7761796)</td>
<td style="text-align: right;">82x (32bp; 7761796)</td>
</tr>
<tr>
<td style="text-align: left;">k-mer Coverage</td>
<td style="text-align: right;">43x (21); 33x (25)</td>
<td style="text-align: right;">30x (21); 20.5x (25)</td>
</tr>
<tr>
<td style="text-align: left;">N50 (k-mer used)</td>
<td style="text-align: right;">2,803 (21)</td>
<td style="text-align: right;">2,914 (21)</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Question</p>
<p>What would you consider as the “best&rdquo; assembly?</p>
</div>
<div class="admonition success">
<details>
<summary>Answer</summary>
<p>SRR023408.trimmed</p>
</details>
</div>
<div class="admonition note">
<p class="admonition-title">Question</p>
<p>If you found a candidate, why do you consider it as “best&rdquo; assembly?</p>
</div>
<div class="admonition success">
<details>
<summary>Answer</summary>
</details>
<p>Overall data quality and coverage</p>
</div>
<div class="admonition note">
<p class="admonition-title">Question</p>
<p>How else might you assess the the quality of an assembly? </p>
</div>
<div class="admonition hint">
<details>
<summary><strong>Hint</strong></summary>
<p>Hawkeye</p>
</details>
</div>
<div class="admonition success">
<details>
<summary>Answer</summary>
<p>By trying to identify paired-end constraint violations using AMOS Hawkeye.</p>
</details>
</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; The authors; 2017-
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.12658920.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.5cf534bf.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
        <script src="../../../js/details.js"></script>
      
    
  </body>
</html>